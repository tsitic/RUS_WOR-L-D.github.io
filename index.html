<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä –í–µ–ª–∏–∫–æ–π –†–æ—Å—Å–∏–∏</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      /* —Ñ–æ–Ω –≤—Å–µ–≥–æ –æ–∫–Ω–∞ ‚Äî —Ü–≤–µ—Ç–∞ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ñ–ª–∞–≥–∞ */
      background: linear-gradient(
        to bottom,
        #ffffff 0%,
        #ffffff 33.33%,
        #1f4ab8 33.33%,
        #1f4ab8 66.66%,
        #ce1c1c 66.66%,
        #ce1c1c 100%
      );
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .app-wrapper {
      width: 100%;
      max-width: 1200px;
      margin: 24px;
      background: rgba(249, 250, 251, 0.96);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.4);
      border: 2px solid #d1d5db;
      display: flex;
      flex-direction: column;
    }

    .app-header {
      padding: 16px 24px;
      background: linear-gradient(to right, #ffffff, #1746a2, #ce1c1c);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .app-header-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .app-title {
      font-size: 1.4rem;
      font-weight: 800;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #111827; /* —á—ë—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
    }

    .flag-emoji {
      font-size: 1.6rem;
    }

    /* –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ —É–¥–∞–ª—ë–Ω */

    .app-badge {
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(249, 250, 251, 0.95);
      color: #111827;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      white-space: nowrap;
      border: 1px solid rgba(15, 23, 42, 0.3);
    }

    .toolbar {
      padding: 8px 12px;
      background: #f3f4f6;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .toolbar-group {
      display: flex;
      gap: 4px;
      padding: 4px;
      border-radius: 999px;
      background: #e5e7eb;
    }

    button.tool-btn {
      border: none;
      padding: 6px 10px;
      border-radius: 999px;
      background: #ffffff;
      font-size: 0.8rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.08s ease;
      white-space: nowrap;
    }

    button.tool-btn span.icon {
      font-size: 0.9rem;
    }

    button.tool-btn:hover {
      background: #eef2ff;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(55, 65, 81, 0.3);
    }

    button.tool-btn:active {
      transform: translateY(0);
      box-shadow: 0 1px 2px rgba(55, 65, 81, 0.2);
    }

    select.tool-select {
      border: none;
      padding: 6px 10px;
      border-radius: 999px;
      background: #ffffff;
      font-size: 0.8rem;
      cursor: pointer;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
      outline: none;
      max-width: 150px;
    }

    .zoom-group {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #e5e7eb;
      font-size: 0.75rem;
      white-space: nowrap;
    }

    .zoom-group input[type="range"] {
      width: 110px;
    }

    .editor-outer {
      flex: 1;
      background: transparent;
      padding: 16px;
      overflow: auto;
    }

    .editor-wrapper {
      margin: 0 auto;
      width: 210mm;
      min-height: 297mm;
      background: #ffffff;
      padding: 20mm 18mm;
      border-radius: 4px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4);
      border: 1px solid #e5e7eb;
      transform-origin: top center;
    }

    #editor {
      min-height: 240mm;
      outline: none;
    }

    #editor img {
      display: block;
      margin: 0;
    }

    /* –º–∞–ª–µ–Ω—å–∫–∞—è —Ä–µ—Å–∞–π–∑–∏–º–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ */
    .resizable {
      display: inline-block;
      position: relative;
      resize: both;
      overflow: hidden;
      border: 1px dashed #9ca3af;
      margin: 8px auto;
      padding: 0;
      max-width: 100%;
      min-width: 40px;
      min-height: 40px;
      width: 160px;
      height: 160px;
    }

    .resizable img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    .status-bar {
      padding: 8px 16px;
      font-size: 0.8rem;
      background: #f9fafb;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      gap: 12px;
    }

    .status-bar span {
      opacity: 0.8;
    }

    /* –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä */
    .music-container {
      padding: 8px 16px;
      background: #e5e7eb;
      border-top: 1px solid #d1d5db;
      display: none;
      flex-direction: column;
      gap: 6px;
    }

    .music-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .music-info {
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .music-title {
      font-weight: 600;
    }

    .link-icon-img {
      height: 20px;
      width: 20px;
      object-fit: contain;
      vertical-align: middle;
      border-radius: 4px;
    }

    @media (max-width: 900px) {
      .app-wrapper {
        margin: 8px;
      }

      .toolbar {
        position: static;
      }

      .editor-outer {
        padding: 8px;
      }

      .editor-wrapper {
        transform-origin: top left;
      }
    }
  </style>
</head>
<body>
  <div class="app-wrapper">
    <header class="app-header">
      <div class="app-header-main">
        <div class="app-title">
          <span class="flag-emoji">üá∑üá∫</span>
          –†–µ–¥–∞–∫—Ç–æ—Ä –†–æ—Å—Å–∏–∏ (A4)
        </div>
      </div>
      <div class="app-badge">
        –° –ª—é–±–æ–≤—å—é –∫ –†–æ–¥–∏–Ω–µ
      </div>
    </header>

    <div class="toolbar">
      <!-- –®—Ä–∏—Ñ—Ç—ã -->
      <div class="toolbar-group">
        <select class="tool-select" onchange="setFontName(this.value)">
          <option value="" disabled selected>–®—Ä–∏—Ñ—Ç</option>
          <option value="Times New Roman">Times New Roman</option>
          <option value="Georgia">Georgia</option>
          <option value="Arial">Arial</option>
          <option value="Verdana">Verdana</option>
          <option value="Courier New">Courier New</option>
        </select>

        <select class="tool-select" onchange="setFontSizePt(this.value)">
          <option value="" disabled selected>–†–∞–∑–º–µ—Ä (pt)</option>
          <option value="10">10 pt</option>
          <option value="11">11 pt</option>
          <option value="12">12 pt</option>
          <option value="14">14 pt</option>
          <option value="16">16 pt</option>
          <option value="18">18 pt</option>
          <option value="24">24 pt</option>
          <option value="32">32 pt</option>
        </select>
      </div>

      <!-- –°—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞ -->
      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="execCmd('bold')">
          <span class="icon"><b>–ñ</b></span> –∂–∏—Ä–Ω—ã–π
        </button>
        <button class="tool-btn" type="button" onclick="execCmd('italic')">
          <span class="icon"><i>–ö</i></span> –∫—É—Ä—Å–∏–≤
        </button>
        <button class="tool-btn" type="button" onclick="execCmd('underline')">
          <span class="icon"><u>–ß</u></span> –ø–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π
        </button>
      </div>

      <!-- –ó–∞–≥–æ–ª–æ–≤–∫–∏ -->
      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="setBlock('H1')">
          <span class="icon">H1</span> –†–æ—Å—Å–∏—è
        </button>
        <button class="tool-btn" type="button" onclick="setBlock('H2')">
          <span class="icon">H2</span> –†–æ–¥–∏–Ω–∞
        </button>
        <button class="tool-btn" type="button" onclick="setBlock('H3')">
          <span class="icon">H3</span> –†—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç
        </button>
      </div>

      <!-- –°–ø–∏—Å–∫–∏ –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ -->
      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="execCmd('insertUnorderedList')">
          ‚Ä¢ –°–ø–∏—Å–æ–∫
        </button>
        <button class="tool-btn" type="button" onclick="execCmd('insertOrderedList')">
          1. –°–ø–∏—Å–æ–∫
        </button>
      </div>

      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="execCmd('justifyLeft')">
          ‚¨Ö –õ–µ–≤–æ
        </button>
        <button class="tool-btn" type="button" onclick="execCmd('justifyCenter')">
          ‚¨å –¶–µ–Ω—Ç—Ä
        </button>
        <button class="tool-btn" type="button" onclick="execCmd('justifyRight')">
          ‚û° –ü—Ä–∞–≤–æ
        </button>
      </div>

      <!-- –†–æ—Å—Å–∏—è-—Å–ø–µ—Ü–∫–Ω–æ–ø–∫–∏ + –∫–∞—Ä—Ç–∏–Ω–∫–∏ -->
      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="insertFlag()">
          <span class="icon">üá∑üá∫</span> –í—Å—Ç–∞–≤–∏—Ç—å —Ñ–ª–∞–≥
        </button>
        <button class="tool-btn" type="button" onclick="insertPatrioticHeader()">
          ‚ú® –ó–∞–≥–æ–ª–æ–≤–æ–∫ –†–æ—Å—Å–∏–∏
        </button>
        <button class="tool-btn" type="button" onclick="triggerImageInput()">
          üñºÔ∏è –í—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        </button>
        <button class="tool-btn" type="button" onclick="insertPutin()">
          ‚òÄ –õ–∏–∫ —Å–æ–ª–Ω—Ü–µ–ª–∏–∫–æ–≤–æ–≥–æ
        </button>
        <button class="tool-btn" type="button" onclick="saveAsWord()">
          üíæ Word
        </button>
      </div>

      <!-- –ú—É–∑—ã–∫–∞ -->
      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="toggleMusicPlayer()">
          üéµ –°–ª—É—à–∞—Ç—å –º—É–∑—ã–∫—É
        </button>
      </div>

      <!-- –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã -->
      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="openLink('https://eais.rkn.gov.ru/feedback/')">
          ‚ö†Ô∏è –î–æ–ª–æ–∂–∏—Ç—å –æ–± —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö
        </button>
        <button class="tool-btn" type="button" onclick="openLink('https://—Ä–µ–µ—Å—Ç—Ä–ø–æ–≤–µ—Å—Ç–æ–∫.—Ä—Ñ/')">
          üìú –†–µ–µ—Å—Ç—Ä –ø–æ–≤–µ—Å—Ç–æ–∫
        </button>
      </div>

      <div class="toolbar-group">
        <button class="tool-btn" type="button" onclick="openLink('https://max.ru/')">
          MAX
        </button>
        <a href="https://max.ru/" target="_blank" title="MAX">
          <img src="img/max.jpg" alt="MAX" class="link-icon-img" />
        </a>
        <a href="https://www.gosuslugi.ru/" target="_blank" title="–ì–æ—Å—É—Å–ª—É–≥–∏">
          <img src="img/gos.png" alt="–ì–æ—Å—É—Å–ª—É–≥–∏" class="link-icon-img" />
        </a>
      </div>

      <!-- –ó—É–º -->
      <div class="zoom-group">
        –ó—É–º:
        <input type="range" min="50" max="200" value="100" id="zoom-range" oninput="setZoom(this.value)" />
        <span id="zoom-label">100%</span>
      </div>
    </div>

    <!-- –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä (–ø–æ –∫–Ω–æ–ø–∫–µ) -->
    <div id="music-container" class="music-container">
      <div class="music-controls">
        <button class="tool-btn" type="button" onclick="prevTrack()">‚èÆ –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
        <button class="tool-btn" type="button" onclick="playPause()" id="play-pause-btn">‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏</button>
        <button class="tool-btn" type="button" onclick="nextTrack()">‚è≠ –°–ª–µ–¥—É—é—â–∏–π</button>
        <button class="tool-btn" type="button" onclick="toggleLoop()" id="loop-btn">üîÅ –ó–∞—Ü–∏–∫–ª–∏—Ç—å</button>
      </div>
      <div class="music-info">
        <span>–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç:</span>
        <span class="music-title" id="music-track-title">‚Äî</span>
      </div>
      <audio id="audio-player"></audio>
    </div>

    <div class="editor-outer">
      <div class="editor-wrapper" id="editor-wrapper">
        <div id="editor" contenteditable="true">
          <h1 style="text-align:center;">–†—É—Å—Å–∫–∏–µ –≤–ø–µ—Ä—ë–¥!!!</h1>
          <p style="font-size:12pt;">
            –°–õ–û–í–ù–û –•–£–ô –î–†–û–ß–ï–ù–´–ô –í –ñ–û–ü–£ –ü–ò–î–û–†–ê!!! –í –£–ö–†–ê–ò–ù–£ –†–ê–¢–¨ –†–û–°–°–ò–ô–°–ö–ê–Ø –í–û–®–õ–ê!!! –ù–ï –û–°–¢–ê–í–ò–í –§–ê–®–ò–ö–ê–ú –ù–ò –í–´–ë–û–†–ê!!! –ê–†–ú–ò–Ø –ù–ê –ö–ò–ï–í –í –ë–û–ô –ü–û–®–õ–ê!!! –°–ö–û–†–û –í–´ –£–ï–ë–ò–©–ê –û–¢–í–ï–¢–ò–¢–ï!!! –ó–ê –ú–ê–ô–î–ê–ù –ó–ê –°–õ–Å–ó–´ –î–û–ù–ë–ê–°–Ø–¢!!! –ï–°–õ–ò –ù–ï –ò–ó–î–û–•–ù–ò–¢–ï –ü–û–ï–î–ï–¢–ï!!! –ù–ê –ö–ò–ß–£ –õ–ï–¢ –ú–ò–ù–ò–ú–£–ú –ù–ê –ü–Ø–¢–¨!!! –í–´ –ú–û–õ–ò–¢–ï–°–¨ –°–£–ö–ò –û –ü–†–û–©–ï–ù–ò–ò!!! –ß–¢–û–ë –í–ê–° –ù–ï–ö–†–û–ú–°–ê–õ–ò –ö–ê–ö –°–í–ò–ù–ï–ô!!! –ú–´ –ò–ú–ï–ï–ú –ü–†–ê–í–û –ù–ê –û–¢–ú–©–ï–ù–ò–ï!!! –ë–û–õ–¨–®–ï –¢–´ –í –ú–ò–†–ù–Ø–ö –°–¢–†–ï–õ–Ø–¢–¨ –ù–ï –°–ú–ï–ô!!! –í–°–¢–ê–ù–¨–¢–ï –ù–ê –ö–û–õ–ï–ù–ò –°–£–ö–ò –ï–ë–ê–ù–´–ï!!! –ü–†–ò–ì–û–¢–û–í–¨–¢–ï–°–¨ –ü–ê–°–¢–¨–Æ –•–£–ô –°–û–°–ê–¢–¨!!! –ñ–û–ü–´ –í–ê–®–ò –ë–£–î–£–¢ –ñ–ï–¢–°–ö–û –í–´–ï–ë–ê–ù–´!!! –¢–û–õ–¨–ö–û –¢–ê–ö –ú–´ –ë–£–î–ï–ú –í–ê–° "–ü–†–û–©–ê–¢–¨"!!! –í–û–°–ï–ú–¨ –õ–ï–¢ –î–û–ù–ë–ê–°–° –•–û–¢–ï–õ–ò –í–´–ï–ë–ê–¢–¨!!! –ê –¢–ï–ü–ï–†–¨ –ñ–ï –í–°–ï –ù–ê–û–ë–û–†–û–¢!!! –ï–°–¢–¨ –£ –í–ê–° –£–ï–ë–ò–© –ü–†–ê–í–û –í–´–ë–ò–†–ê–¢–¨!!! –†–£–°–°–ö–ò–ô –•–£–ô –°–û–í–ê–¢–¨ –ò–õ–¨ –í –ñ–û–ü–£ –ò–õ–ò –í–†–û–¢!!! –° –£–í–ê–ñ–ï–ù–ò–ï–ú –î–ï–ù–ò–° –ß–ï–†–ù–£–•–ò–ù 22 –ú–ê–†–¢–ê 2022 –ì–û–î–ê –ì. –°–ï–†–ü–£–•–û–í
          </p>
        </div>
      </div>
    </div>

    <div class="status-bar">
      <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞: —Ñ–æ—Ä–º–∞—Ç A4 (210√ó297 –º–º) ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: .doc (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ Word –∏ –∞–Ω–∞–ª–æ–≥–∞—Ö)</span>
      <span id="status-info">–ì–æ—Ç–æ–≤ –∫ –≤–≤–æ–¥—É —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –†–æ—Å—Å–∏–∏ üá∑üá∫</span>
    </div>
  </div>

  <!-- –°–∫—Ä—ã—Ç—ã–π –∏–Ω–ø—É—Ç –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
  <input
    type="file"
    id="image-input"
    accept="image/*"
    style="display:none"
    onchange="insertImageFromFile(event)"
  />

  <script>
    function focusEditor() {
      document.getElementById('editor').focus();
    }

    function execCmd(command, value = null) {
      focusEditor();
      document.execCommand(command, false, value);
      updateStatus();
    }

    function setFontName(fontName) {
      if (!fontName) return;
      execCmd('fontName', fontName);
    }

    // —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –≤ pt
    function setFontSizePt(pt) {
      if (!pt) return;
      focusEditor();
      document.execCommand('fontSize', false, '4');
      const editor = document.getElementById('editor');
      const fonts = editor.getElementsByTagName('font');
      for (let i = 0; i < fonts.length; i++) {
        fonts[i].removeAttribute('size');
        fonts[i].style.fontSize = pt + 'pt';
      }
      updateStatus(`–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞: ${pt} pt`);
    }

    function setBlock(block) {
      execCmd('formatBlock', block);
    }

    function insertFlag() {
      focusEditor();
      document.execCommand('insertText', false, ' üá∑üá∫ ');
      updateStatus('–í—Å—Ç–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ –†–æ—Å—Å–∏–∏.');
    }

    function insertPatrioticHeader() {
      const templates = [
        '–°–ª–∞–≤–∞ –≤–µ–ª–∏–∫–æ–π –†–æ—Å—Å–∏–∏!',
        '–†–æ—Å—Å–∏—è ‚Äî –Ω–∞—à–∞ —Å–∏–ª–∞ –∏ –±—É–¥—É—â–µ–µ!',
        '–†–æ–¥–∏–Ω–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–∏—à–µ–º —Å–ª–æ–≤–∞–º–∏.',
        '–†—É—Å—Å–∫–∏–π –¥—É—Ö, —Ä—É—Å—Å–∫–æ–µ —Å–ª–æ–≤–æ, —Ä—É—Å—Å–∫–∞—è —Å–∏–ª–∞.',
        '–†–æ—Å—Å–∏—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç, –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –∏ –≤–µ–¥—ë—Ç –≤–ø–µ—Ä—ë–¥.'
      ];
      const text = templates[Math.floor(Math.random() * templates.length)];
      const html =
        '<h2 style="text-align:center;">' +
        text +
        ' üá∑üá∫</h2><p style="font-size:12pt;"></p>';
      focusEditor();
      document.execCommand('insertHTML', false, html);
      updateStatus('–î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ç—Ä–∏–æ—Ç–∏—á–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.');
    }

    function triggerImageInput() {
      document.getElementById('image-input').value = '';
      document.getElementById('image-input').click();
    }

    // –≤—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏
    function insertImageFromFile(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (e) {
        const dataURL = e.target.result;
        focusEditor();
        const html =
          '<span class="resizable"><img src="' +
          dataURL +
          '" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" /></span>';
        document.execCommand('insertHTML', false, html);
        updateStatus('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–æ (–º–æ–∂–Ω–æ —Ç—è–Ω—É—Ç—å –∑–∞ —É–≥–æ–ª–∫–∏).');
      };
      reader.readAsDataURL(file);
    }

    // –≤—Å—Ç–∞–≤–∫–∞ putin.jpg
    function insertPutin() {
      focusEditor();
      const html =
        '<span class="resizable">' +
        '<img src="img/putin.jpg" alt="–õ–∏–∫ —Å–æ–ª–Ω—Ü–µ–ª–∏–∫–æ–≤–æ–≥–æ" />' +
        '</span>';
      document.execCommand('insertHTML', false, html);
      updateStatus('–í—Å—Ç–∞–≤–ª–µ–Ω –ª–∏–∫ —Å–æ–ª–Ω—Ü–µ–ª–∏–∫–æ–≤–æ–≥–æ (putin.jpg) ‚Äî –ø–æ—Ç—è–Ω–∏ –∑–∞ —É–≥–æ–ª–∫–∏.');
    }

    function saveAsWord() {
      const header =
        '<html xmlns:o="urn:schemas-microsoft-com:office:office" ' +
        'xmlns:w="urn:schemas-microsoft-com:office:word" ' +
        'xmlns="http://www.w3.org/TR/REC-html40">' +
        '<head><meta charset="utf-8"><title>–î–æ–∫—É–º–µ–Ω—Ç –†–æ—Å—Å–∏–∏</title></head><body>';
      const footer = '</body></html>';

      const content = document.getElementById('editor').innerHTML;
      const sourceHTML = header + content + footer;
      const blob = new Blob(['\ufeff', sourceHTML], {
        type: 'application/msword'
      });

      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      const date = new Date().toISOString().slice(0, 10);
      link.href = url;
      link.download = 'Russia_Text_' + date + '.doc';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      updateStatus('–î–æ–∫—É–º–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ Word (.doc).');
    }

    function setZoom(percent) {
      const wrapper = document.getElementById('editor-wrapper');
      const zoom = percent / 100;
      wrapper.style.transform = 'scale(' + zoom + ')';
      document.getElementById('zoom-label').textContent = percent + '%';
    }

    function updateStatus(custom) {
      const editor = document.getElementById('editor');
      const text = editor.innerText || '';
      const words = text
        .trim()
        .split(/\s+/)
        .filter(Boolean).length;
      const chars = text.replace(/\s/g, '').length;

      const base = `–°–ª–æ–≤: ${words} ‚Ä¢ –°–∏–º–≤–æ–ª–æ–≤ (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤): ${chars}`;
      document.getElementById('status-info').textContent =
        custom ? custom + ' | ' + base : base;
    }

    function openLink(url) {
      window.open(url, '_blank');
    }

    // --- –ú—É–∑—ã–∫–∞ ---
    const playlist = [
      { src: 'music/track1.mp3', title: '–¢—Ä–µ–∫ 1' },
      { src: 'music/track2.mp3', title: '–¢—Ä–µ–∫ 2' },
      { src: 'music/track3.mp3', title: '–¢—Ä–µ–∫ 3' },
      { src: 'music/track4.mp3', title: '–¢—Ä–µ–∫ 4' }
    ];

    let currentTrack = 0;
    let isPlaying = false;
    let musicInited = false;

    let audioPlayer;
    let trackTitleEl;
    let playPauseBtn;
    let loopBtn;

    function initMusicRefs() {
      audioPlayer = document.getElementById('audio-player');
      trackTitleEl = document.getElementById('music-track-title');
      playPauseBtn = document.getElementById('play-pause-btn');
      loopBtn = document.getElementById('loop-btn');

      audioPlayer.addEventListener('ended', function () {
        if (!audioPlayer.loop) {
          nextTrack();
        }
      });
    }

    function loadTrack(index) {
      if (!audioPlayer) return;
      if (index < 0) index = playlist.length - 1;
      if (index >= playlist.length) index = 0;
      currentTrack = index;
      audioPlayer.src = playlist[currentTrack].src;
      trackTitleEl.textContent = playlist[currentTrack].title;
      audioPlayer.load();
    }

    function playPause() {
      if (!audioPlayer) return;
      if (audioPlayer.paused) {
        audioPlayer.play();
        isPlaying = true;
        playPauseBtn.textContent = '‚è∏ –ü–∞—É–∑–∞';
      } else {
        audioPlayer.pause();
        isPlaying = false;
        playPauseBtn.textContent = '‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏';
      }
    }

    function nextTrack() {
      if (!audioPlayer) return;
      loadTrack(currentTrack + 1);
      if (isPlaying) {
        audioPlayer.play();
      }
    }

    function prevTrack() {
      if (!audioPlayer) return;
      loadTrack(currentTrack - 1);
      if (isPlaying) {
        audioPlayer.play();
      }
    }

    function toggleLoop() {
      if (!audioPlayer) return;
      audioPlayer.loop = !audioPlayer.loop;
      loopBtn.textContent = audioPlayer.loop ? 'üîÅ –ü–æ–≤—Ç–æ—Ä: –≤–∫–ª' : 'üîÅ –ó–∞—Ü–∏–∫–ª–∏—Ç—å';
    }

    function toggleMusicPlayer() {
      const cont = document.getElementById('music-container');
      if (!musicInited) {
        initMusicRefs();
        loadTrack(0);
        musicInited = true;
      }
      if (cont.style.display === 'none' || cont.style.display === '') {
        cont.style.display = 'flex';
      } else {
        cont.style.display = 'none';
      }
    }

    document.getElementById('editor').addEventListener('input', function () {
      updateStatus();
    });

    // initial
    updateStatus();
    setZoom(100);
    initMusicRefs();
  </script>
</body>
</html>
